<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>Docs for page caldav-PUT-functions.php</title>
			<link rel="stylesheet" href="../../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
			<div class="page-body">			
<h2 class="file-name"><img src="../../media/images/Page_logo.png" alt="File" style="vertical-align: middle">/inc/caldav-PUT-functions.php</h2>

<a name="sec-description"></a>
<div class="info-box">
	<div class="info-box-title">Description</div>
	<div class="nav-bar">
					<span class="disabled">Description</span> |
									<a href="#sec-includes">Includes</a>
			|											<a href="#sec-functions">Functions</a>
			</div>
	<div class="info-box-body">	
		<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">CalDAV Server - handle PUT method</p>
	<ul class="tags">
				<li><span class="field">author:</span> Andrew McMillan &lt;<a href="mailto:andrew@morphoss.com">andrew@morphoss.com</a>&gt;</li>
				<li><span class="field">copyright:</span> Morphoss Ltd - http://www.morphoss.com/</li>
				<li><span class="field">license:</span> <a href="http://gnu.org/copyleft/gpl.html">GNU GPL v2 or later version</a></li>
			</ul>
		
			</div>
</div>
		

	<a name="sec-includes"></a>	
	<div class="info-box">
		<div class="info-box-title">Includes</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
						<span class="disabled">Includes</span>
			|													<a href="#sec-functions">Functions</a>
					</div>
		<div class="info-box-body">	
			<a name="_WritableCollection_php"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name"><a href="../../davical/_inc---WritableCollection.php.html">'WritableCollection.php'</a></span>)
			(line <span class="line-number">19</span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
	
</div>
<a name="_iCalendar_php"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Page.png" alt=" " />
		<span class="include-title">
			<span class="include-type">require_once</span>
			(<span class="include-name">'iCalendar.php'</span>)
			(line <span class="line-number">18</span>)
		</span>
	</div>

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Check if the user wants to put just one VEVENT/VTODO or a whole calendar</p>
<p class="description"><p>if the collection = calendar = $request_container doesn't exist then create it  return true if it's a whole calendar</p></p>
	
</div>
		</div>
	</div>
	
	
	
	<a name="sec-functions"></a>	
	<div class="info-box">
		<div class="info-box-title">Functions</div>
		<div class="nav-bar">
			<a href="#sec-description">Description</a> |
										<a href="#sec-includes">Includes</a>
				|												<span class="disabled">Functions</span>
		</div>
		<div class="info-box-body">	
			<a name="functioncontrolRequestContainer" id="functioncontrolRequestContainer"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">controlRequestContainer</span> (line <span class="line-number">67</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Work out the location we are doing the PUT to, and check that we have the rights to  do the needful.</p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			controlRequestContainer
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$username</span>, <span class="var-type">int</span>&nbsp;<span class="var-name">$user_no</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>, <span class="var-type">boolean</span>&nbsp;<span class="var-name">$caldav_context</span>, [<span class="var-type">boolean</span>&nbsp;<span class="var-name">$public</span> = <span class="var-default">null</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$username</span><span class="var-description">: The name of the destination user</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$user_no</span><span class="var-description">: The user making the change</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span><span class="var-description">: The DAV path the resource is bing PUT to</span>			</li>
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$caldav_context</span><span class="var-description">: Whether we are responding via CalDAV or interactively</span>			</li>
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$public</span><span class="var-description">: Whether the collection will be public, should we need to create it</span>			</li>
				</ul>
		
	
</div>
<a name="functioncreate_scheduling_requests" id="functioncreate_scheduling_requests"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">create_scheduling_requests</span> (line <span class="line-number">338</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Create scheduling requests in the schedule inbox for the</p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			create_scheduling_requests
		</span>
					(<span class="var-type"></span>&nbsp;<span class="var-name">&$resource</span>, <span class="var-type">iCalComponent</span>&nbsp;<span class="var-name">$resource</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">iCalComponent</span>
				<span class="var-name">$resource</span><span class="var-description">: The VEVENT/VTODO/... resource we are scheduling</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">&$resource</span>			</li>
				</ul>
		
	
</div>
<a name="functionhandle_schedule_reply" id="functionhandle_schedule_reply"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">handle_schedule_reply</span> (line <span class="line-number">251</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Deliver scheduling replies to organizer and other attendees</p>
	<ul class="tags">
				<li><span class="field">return:</span> on error</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">false</span>
		<span class="method-name">
			handle_schedule_reply
		</span>
					(<span class="var-type">iCalComponent</span>&nbsp;<span class="var-name">$ical</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">iCalComponent</span>
				<span class="var-name">$ical</span><span class="var-description">: the VCALENDAR to deliver</span>			</li>
				</ul>
		
	
</div>
<a name="functionhandle_schedule_request" id="functionhandle_schedule_request"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">handle_schedule_request</span> (line <span class="line-number">165</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Deliver scheduling requests to attendees</p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			handle_schedule_request
		</span>
					(<span class="var-type">iCalComponent</span>&nbsp;<span class="var-name">$ical</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">iCalComponent</span>
				<span class="var-name">$ical</span><span class="var-description">: the VCALENDAR to deliver</span>			</li>
				</ul>
		
	
</div>
<a name="functionimport_collection" id="functionimport_collection"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">import_collection</span> (line <span class="line-number">403</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This function will import a whole calendar</p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			import_collection
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$ics_content</span>, <span class="var-type">int</span>&nbsp;<span class="var-name">$user_no</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>, <span class="var-type">boolean</span>&nbsp;<span class="var-name">$caldav_context</span>, [<span class="var-type"></span>&nbsp;<span class="var-name">$appending</span> = <span class="var-default">false</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$ics_content</span><span class="var-description">: the ics file to import</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$user_no</span><span class="var-description">: the user wich will receive this ics file</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span><span class="var-description">: the $path where it will be store such as /user_foo/home/</span>			</li>
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$caldav_context</span><span class="var-description">: <p>Whether we are responding via CalDAV or interactively</p><p>Any VEVENTs with the same UID will be concatenated together</p></span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$appending</span>			</li>
				</ul>
		
	
</div>
<a name="functionpublic_events_only" id="functionpublic_events_only"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">public_events_only</span> (line <span class="line-number">141</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Check if this collection should force all events to be PUBLIC.</p>
	<ul class="tags">
				<li><span class="field">return:</span> Return true if public events only are allowed.</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">boolean</span>
		<span class="method-name">
			public_events_only
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$user_no</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$dav_name</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$user_no</span><span class="var-description">: the user that owns the collection</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$dav_name</span><span class="var-description">: the collection to check</span>			</li>
				</ul>
		
	
</div>
<a name="functionrollback_on_error" id="functionrollback_on_error"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">rollback_on_error</span> (line <span class="line-number">36</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">This function launches an error</p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			rollback_on_error
		</span>
					(<span class="var-type">boolean</span>&nbsp;<span class="var-name">$caldav_context</span>, <span class="var-type">int</span>&nbsp;<span class="var-name">$user_no</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>, [<span class="var-type">string</span>&nbsp;<span class="var-name">$message</span> = <span class="var-default">&#039;&#039;</span>], [<span class="var-type">int</span>&nbsp;<span class="var-name">$error_no</span> = <span class="var-default">500</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$caldav_context</span><span class="var-description">: Whether we are responding via CalDAV or interactively</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$user_no</span><span class="var-description">: the user who will receive this ics file</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span><span class="var-description">: the $path where the PUT failed to store such as /user_foo/home/</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$message</span><span class="var-description">: An optional error message to return to the client</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$error_no</span><span class="var-description">: An optional value for the HTTP error code</span>			</li>
				</ul>
		
	
</div>
<a name="functionsimple_write_resource" id="functionsimple_write_resource"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">simple_write_resource</span> (line <span class="line-number">1006</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">A slightly simpler version of write_resource which will make more sense for calling from  an external program.  This makes assumptions that the collection and user do exist  and bypasses all checks for whether it is reasonable to write this here.</p>
	<ul class="tags">
				<li><span class="field">return:</span> True for success, false for failure.</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">boolean</span>
		<span class="method-name">
			simple_write_resource
		</span>
					(<span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$caldav_data</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$put_action_type</span>, [<span class="var-type"></span>&nbsp;<span class="var-name">$write_action_log</span> = <span class="var-default">false</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span><span class="var-description">: The path to the resource being written</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$caldav_data</span><span class="var-description">: The actual resource to be written</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$put_action_type</span><span class="var-description">: INSERT or UPDATE depending on what we are to do</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$write_action_log</span>			</li>
				</ul>
		
	
</div>
<a name="functionupdate_scheduling_requests" id="functionupdate_scheduling_requests"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">update_scheduling_requests</span> (line <span class="line-number">368</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Update scheduling requests in the schedule inbox for the</p>
	<div class="method-signature">
		<span class="method-result">void</span>
		<span class="method-name">
			update_scheduling_requests
		</span>
					(<span class="var-type"></span>&nbsp;<span class="var-name">&$resource</span>, <span class="var-type">iCalComponent</span>&nbsp;<span class="var-name">$resource</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">iCalComponent</span>
				<span class="var-name">$resource</span><span class="var-description">: The VEVENT/VTODO/... resource we are scheduling</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">&$resource</span>			</li>
				</ul>
		
	
</div>
<a name="functionwrite_alarms" id="functionwrite_alarms"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">write_alarms</span> (line <span class="line-number">641</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Given a dav_id and an original iCalComponent, pull out each of the VALARMs  and write the values into the calendar_alarm table.</p>
	<div class="method-signature">
		<span class="method-result">null</span>
		<span class="method-name">
			write_alarms
		</span>
					(<span class="var-type">int</span>&nbsp;<span class="var-name">$dav_id</span>, <span class="var-type">iCalComponent</span>&nbsp;<span class="var-name">$ical</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$dav_id</span><span class="var-description">: The dav_id of the caldav_data we're processing</span>			</li>
					<li>
				<span class="var-type">iCalComponent</span>
				<span class="var-name">$ical</span><span class="var-description">: The VEVENT or VTODO containing the VALARM</span>			</li>
				</ul>
		
	
</div>
<a name="functionwrite_attendees" id="functionwrite_attendees"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">write_attendees</span> (line <span class="line-number">690</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Parse out the attendee property and write a row to the  calendar_attendee table for each one.</p>
	<div class="method-signature">
		<span class="method-result">null</span>
		<span class="method-name">
			write_attendees
		</span>
					(<span class="var-type">int</span>&nbsp;<span class="var-name">$dav_id</span>, <span class="var-type">iCalComponent</span>&nbsp;<span class="var-name">$ical</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$dav_id</span><span class="var-description">: The dav_id of the caldav_data we're processing</span>			</li>
					<li>
				<span class="var-type">iCalComponent</span>
				<span class="var-name">$ical</span><span class="var-description">: The VEVENT or VTODO containing the ATTENDEEs</span>			</li>
				</ul>
		
	
</div>
<a name="functionwrite_resource" id="functionwrite_resource"><!-- --></a>
<div class="oddrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">write_resource</span> (line <span class="line-number">739</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Actually write the resource to the database.  All checking of whether this is reasonable  should be done before this is called.</p>
	<ul class="tags">
				<li><span class="field">return:</span> True for success, false for failure.</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">boolean</span>
		<span class="method-name">
			write_resource
		</span>
					(<span class="var-type">int</span>&nbsp;<span class="var-name">$user_no</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$path</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$caldav_data</span>, <span class="var-type">int</span>&nbsp;<span class="var-name">$collection_id</span>, <span class="var-type">int</span>&nbsp;<span class="var-name">$author</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$etag</span>, <span class="var-type">object</span>&nbsp;<span class="var-name">$ic</span>, <span class="var-type">string</span>&nbsp;<span class="var-name">$put_action_type</span>, <span class="var-type">boolean</span>&nbsp;<span class="var-name">$caldav_context</span>, [<span class="var-type">string</span>&nbsp;<span class="var-name">$log_action</span> = <span class="var-default">true</span>], [<span class="var-type">string</span>&nbsp;<span class="var-name">$weak_etag</span> = <span class="var-default">null</span>])
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$user_no</span><span class="var-description">: The user_no owning this resource on the server</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$path</span><span class="var-description">: The path to the resource being written</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$caldav_data</span><span class="var-description">: The actual resource to be written</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$collection_id</span><span class="var-description">: The ID of the collection containing the resource being written</span>			</li>
					<li>
				<span class="var-type">int</span>
				<span class="var-name">$author</span><span class="var-description">: The user_no who wants to put this resource on the server</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$etag</span><span class="var-description">: An etag unique for this event</span>			</li>
					<li>
				<span class="var-type">object</span>
				<span class="var-name">$ic</span><span class="var-description">: The parsed iCalendar object</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$put_action_type</span><span class="var-description">: INSERT or UPDATE depending on what we are to do</span>			</li>
					<li>
				<span class="var-type">boolean</span>
				<span class="var-name">$caldav_context</span><span class="var-description">: True, if we are responding via CalDAV, false for other ways of calling this</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$log_action</span><span class="var-description">: Either 'INSERT' or 'UPDATE': the type of action we are doing</span>			</li>
					<li>
				<span class="var-type">string</span>
				<span class="var-name">$weak_etag</span><span class="var-description">: An etag that is NOT modified on ATTENDEE changes for this event</span>			</li>
				</ul>
		
	
</div>
<a name="functionwrite_scheduling_request" id="functionwrite_scheduling_request"><!-- --></a>
<div class="evenrow">
	
	<div>
		<img src="../../media/images/Function.png" />
		<span class="method-title">write_scheduling_request</span> (line <span class="line-number">313</span>)
	</div> 

	<!-- ========== Info from phpDoc block ========= -->
<p class="short-description">Create a scheduling request in the schedule inbox for the</p>
	<ul class="tags">
				<li><span class="field">return:</span> The result of the scheduling request, per caldav-sched #3.5.4</li>
			</ul>
	<div class="method-signature">
		<span class="method-result">float</span>
		<span class="method-name">
			write_scheduling_request
		</span>
					(<span class="var-type"></span>&nbsp;<span class="var-name">&$resource</span>, <span class="var-type"></span>&nbsp;<span class="var-name">$attendee_value</span>, <span class="var-type"></span>&nbsp;<span class="var-name">$create_resource</span>, <span class="var-type">iCalComponent</span>&nbsp;<span class="var-name">$resource</span>, <span class="var-type">iCalProp</span>&nbsp;<span class="var-name">$attendee</span>)
			</div>

			<ul class="parameters">
					<li>
				<span class="var-type">iCalComponent</span>
				<span class="var-name">$resource</span><span class="var-description">: The VEVENT/VTODO/... resource we are scheduling</span>			</li>
					<li>
				<span class="var-type">iCalProp</span>
				<span class="var-name">$attendee</span><span class="var-description">: The attendee we are scheduling</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">&$resource</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$attendee_value</span>			</li>
					<li>
				<span class="var-type"></span>
				<span class="var-name">$create_resource</span>			</li>
				</ul>
		
	
</div>
		</div>
	</div>
	
	<p class="notes" id="credit">
		Documentation generated on Tue, 28 Dec 2010 02:16:03 +1300 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.4.3</a>
	</p>
	</div></body>
</html>