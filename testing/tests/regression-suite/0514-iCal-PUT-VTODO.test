#
# PUT an iCal style event into the database
#
TYPE=PUT
URL=http://mycaldav/caldav.php/user1/6E20BB7C-EFD9-4F0F-9BDC-5335E04D47E0/E6BC62F3-77C6-4FB7-BDD3-6882E2F1BE74.ics
HEADER=Content-Type: text/calendar
HEADER=User-Agent: DAVKit/2.0 (10.5.1; wrbt) iCal 3.0.1
HEAD


BEGINDATA
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//Apple Inc.//iCal 3.0//EN
CALSCALE:GREGORIAN
BEGIN:VTIMEZONE
TZID:Pacific/Auckland
BEGIN:STANDARD
TZOFFSETFROM:+1300
TZOFFSETTO:+1200
DTSTART:19900318T030000
RRULE:FREQ=YEARLY;UNTIL=20070317T140000Z;BYMONTH=3;BYDAY=3SU
TZNAME:NZST
END:STANDARD
BEGIN:DAYLIGHT
TZOFFSETFROM:+1200
TZOFFSETTO:+1300
DTSTART:19901007T020000
RRULE:FREQ=YEARLY;UNTIL=20060930T140000Z;BYMONTH=10;BYDAY=1SU
TZNAME:NZDT
END:DAYLIGHT
END:VTIMEZONE
BEGIN:VTODO
PRIORITY:5
SEQUENCE:7
DESCRIPTION:Organise a party
UID:E6BC62F3-77C6-4FB7-BDD3-6882E2F1BE74
DTSTART;TZID=Pacific/Auckland:20040101T120000
DTSTAMP:20071124T220925Z
SUMMARY:Celebrate a significant birthday
CREATED:20071124T220749Z
X-APPLE-SORT-ORDER:2147483647
DUE;VALUE=DATE:20100217
END:VTODO
END:VCALENDAR
ENDDATA


QUERY
SELECT caldav_data.user_no, caldav_data.dav_etag, caldav_type, logged_user, 
       uid, dtstamp, dtstart at time zone tz_locn as dtstart, dtend at time zone tz_locn as dtend, due at time zone tz_locn as due, summary, location,
       description, priority, class, transp, rrule, url,
       percent_complete, tz_id, status,
       caldav_data AS " CalDAV Data", last_modified
FROM caldav_data JOIN calendar_item USING(dav_name) JOIN time_zone USING (tz_id)
WHERE caldav_data.dav_name =
'/user1/6E20BB7C-EFD9-4F0F-9BDC-5335E04D47E0/E6BC62F3-77C6-4FB7-BDD3-6882E2F1BE74.ics';
ENDQUERY

